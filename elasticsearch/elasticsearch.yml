### ELASTICSEARCH.YML
#
# Replace `chevalier-XX{,local}` as required
#


# Cluster ##############################################################

# Cluster name identifies your cluster for auto-discovery. If you're 
# running multiple clusters on the same network, make sure you're using 
# unique names.
#
cluster.name: "chevalier-XX"

cluster.routing.allocation.allow_rebalance: "indices_all_active"
cluster.routing.allocation.cluster_concurrent_rebalance: "2"

# Node #################################################################

node.name: "chevalier-XX.local"
node.master: true
node.data: true
node.fqdn: "chevalier-XX.local"
node.max_local_storage_nodes: 1

# Index ################################################################
index.number_of_shards: 5
index.number_of_replicas: 1


# Index caching ########################################################
index.cache.field.type: "soft"
index.cache.field.max_size: 10000
index.cache.field.expire: "5m"

# Plugins ##############################################################
plugin.mandatory: ""


# Memory ###############################################################
bootstrap.mlockall: true

# Gateway ##############################################################
gateway.recover_after_master_nodes: 1
gateway.recover_after_data_nodes: 1
gateway.recover_after_time: 5m
gateway.expected_master_nodes: 2
gateway.expected_data_nodes: 1


# Throttling ###########################################################
# Search pool
threadpool.search.type: fixed
threadpool.search.size: 20
threadpool.search.queue_size: 100
threadpool.search.reject_policy: abort

# Bulk pool
threadpool.bulk.type: fixed
threadpool.bulk.size: 100
threadpool.bulk.queue_size: 4000
threadpool.bulk.reject_policy: caller

# Index pool
threadpool.index.type: fixed
threadpool.index.size: 20
threadpool.index.queue_size: 100
threadpool.index.reject_policy: abort


# Slow query log #######################################################

index.search.slowlog.level: TRACE
index.search.slowlog.threshold.query.warn: 10s
index.search.slowlog.threshold.query.info: 5s
index.search.slowlog.threshold.query.debug: 2s
index.search.slowlog.threshold.query.trace: 500ms

index.search.slowlog.threshold.fetch.warn: 1s
index.search.slowlog.threshold.fetch.info: 800ms
index.search.slowlog.threshold.fetch.debug: 500ms
index.search.slowlog.threshold.fetch.trace: 200ms


# Garbage collection ###################################################

jmx.create_connector: true
jmx.port: 9400
jmx.domain: elasticsearch

index.translog.flush_threshold_size: 200mb
index.translog.flush_threshold_period: 30m


# Disable dynamic scripting (SECURITY) #################################
script.disable_dynamic: true


# Discovery ############################################################
discovery.zen.minimum_master_nodes: 1

discovery.zen.ping.timeout: 45s
discovery.zen.ping.retries: 3
discovery.zen.ping.interval: 1s
discovery.zen.ping.multicast.enabled: false

discovery.zen.ping.unicast.hosts:
    - "chevalier-XX.local"
